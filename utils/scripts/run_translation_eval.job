#!/bin/bash

#SBATCH --partition=gpu
#SBATCH --gpus=1
#SBATCH --job-name=RunTranslationEval
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=18
#SBATCH --time=04:00:00
#SBATCH --output=/home/scur1769/ALMA-Matters/utils/script_outputs/RunTranslationEval_%A.out

module purge
module load 2022
module load Anaconda3/2022.05

source activate DL4_env

python -uc "import torch; print('GPU available?', torch.cuda.is_available())"

cd $HOME/ALMA-Matters/evaluation/

echo "+++Directory: $(pwd)"

python translation_eval.py \
        --fin $HOME/ALMA-Matters/data/translation/test.eng_Latn.deu_Latn.tsv \
        --fout $HOME/ALMA-Matters/data/translation/test.eng_Latn.deu_Latn.tsv \
        --ckpt $HOME/ALMA-Matters/models/ALMA-7B \
        --src eng_Latn \
        --tgt deu_Latn \
        --dtype float16 \
        --model haoranxu/ALMA-7B \
        --beam 5 \
        --gen_max_tokens 256 \
        --batch_size 8
    